## 指令周期

**指令周期**: CPU从主存中**取出**并**执行**一条指令的时间

<img src="https://pic-1257412153.cos.ap-nanjing.myqcloud.com/images/2023/06/14/image-20230614212447177-5ff445.png" alt="image-20230614212447177" style="zoom:50%;" />

**指令周期**与**机器周期**：一个机器周期由多个时钟周期组成，时钟周期为CPU操作的基本单位

![image-20230614212431790](https://pic-1257412153.cos.ap-nanjing.myqcloud.com/images/2023/06/14/image-20230614212431790-360ddf.png)

定长机器周期：每个指令的机器周期数量相同。不定长：每个指令可能不一样长。

### 指令周期流程



![指令周期流程](https://pic-1257412153.cos.ap-nanjing.myqcloud.com/images/2023/06/14/image-20230614212938520-2b28d9.png)

#### 取值阶段

1. `(PC) -> MAR`
2. CU送**读**控制信号到总线
3. `M(MAR) -> MDR`：主存的内容放到`MDR`
4. `(MDR) -> IR`
5. `PC++`

#### 间接寻址阶段

1. `Ad(IR) -> MAR` 或 `Ad(MDR) -> MAR`
2. CU读：`1 -> R`
3. `M(MAR) -> MDR`：主存的内容放到`MDR`

#### 执行阶段

see: TODO

#### 中断阶段

执行对应中断处理程序，使用堆栈保持当前信息，处理后回到当前状态

1. `(SP)-1 -> SP, (SP)->MAR`：CU将SP--，修改后送入MAR。
2. `1->W`：主存写数据
3. 中断处理程序送入PC

## 指令执行方案

### 单指令周期

所有指令的周期相同

### 多指令周期

不同指令的时钟周期数不同，效率更高

### 流水线方案

指令级并行，每个时钟周期执行一个微指令，多个指令同时运行。

![CSAPP-流水线](https://pic-1257412153.cos.ap-nanjing.myqcloud.com/images/2023/06/14/image-20230614214805807-cc864c.png)