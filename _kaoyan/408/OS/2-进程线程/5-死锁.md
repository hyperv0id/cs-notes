## 定义



进程因竞争资源导致的的**僵局**，进程会互相等待对方。

<img src="https://pic-1257412153.cos.ap-nanjing.myqcloud.com/images/2023/06/25/DeadLock-Meme-d64605.webp" alt="DeadLock-Meme, from:https://br.ifunny.co/picture/threads-i-programmed-stuck-on-a-deadiock-rG7b76Vr8" style="zoom:50%;" />



### 死锁的资源分配图表示

如果能够发现资源分配图包含**环**路那么就有死锁🙃

![img](https://pic-1257412153.cos.ap-nanjing.myqcloud.com/images/2023/06/25/2022-11-19-01-16-49-01b5fd.png)

## 死锁条件

1. 资源非共享
2. 一个占有一个等待
3. 资源不能抢占，只能等待
4. 循环等待

## 死锁处理

- 不会死锁
  - **死锁预防**
  - **死锁避免**
- **死锁恢复**：数据库的实现
- 假装不会死锁（大部分OS的实现

### 死锁预防

破坏死锁的任意条件就可以预防

#### 破坏资源共享条件

假设物质极大丰富，所有资源按需分配，所有资源都可以共享🙃

#### 破坏占有并等待

占有时不能申请，需要提前一次性申请**全部**资源。

**资源利用率较低**，还会发生**饥饿**

#### 破坏不能抢占

一命通关：申请失败会丢失所有资源。

#### 破坏循环等待

资源排序，要求进程按递增顺序申请

### 死锁避免

如果我给你会导致死锁，那就不给你。

#### 安全状态

<img src="https://pic-1257412153.cos.ap-nanjing.myqcloud.com/images/2023/06/25/2022-11-19-17-53-11-1cf576-fb297a.png" alt="死锁与安全状态的关系" style="zoom:50%;" />

#### 银行家算法





### 死锁恢复







## Reference

[^1]: https://br.ifunny.co/picture/threads-i-programmed-stuck-on-a-deadiock-rG7b76Vr8

